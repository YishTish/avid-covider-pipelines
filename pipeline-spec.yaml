github_pull_covid19_israel:
  schedule:
    crontab: "* * * * *"
  pipeline:
    - flow: avid_covider_pipelines.github_pull_covid19_israel
      parameters:
        dump_to_path: data/github_pull_covid19_israel


corona_data_collector:
  schedule:
    crontab: "0 2 * * *"
  pipeline:
    - flow: avid_covider_pipelines.corona_data_collector_flow
      parameters:
        output-dir: data/corona_data_collector


get_raw_data:
  dependencies:
    - pipeline: ./corona_data_collector
    - datapackage: data/github_pull_covid19_israel/datapackage.json
  pipeline:
    - flow: avid_covider_pipelines.run_covid19_israel
      parameters:
        module: src.utils.get_raw_data
        output-dir: data/get_raw_data


preprocess_raw_data:
  dependencies:
    - pipeline: ./get_raw_data
  pipeline:
    - flow: avid_covider_pipelines.run_covid19_israel
      parameters:
        module: src.utils.preprocess_raw_data
        output-dir: data/preprocess_raw_data


lamas_features:
  dependencies:
    - pipeline: ./preprocess_raw_data
  pipeline:
    - flow: avid_covider_pipelines.run_covid19_israel
      parameters:
        module: src.utils.lamas_features
        args: ["--if-not-exists"]
        output-dir: data/lamas_features


dashboard_generate_cache:
  dependencies:
    - pipeline: ./lamas_features
  pipeline:
    - flow: avid_covider_pipelines.run_covid19_israel
      parameters:
        module: Dashboard.generate_cache
        output-dir: data/dashboard_generate_cache


figures_plotly_top_bottom_cities:
  dependencies:
    - pipeline: ./dashboard_generate_cache
  pipeline:
    - flow: avid_covider_pipelines.run_covid19_israel
      parameters:
        module: src.figures.plotly_top_bottom_cities
        output-dir: data/figures_plotly_top_bottom_cities
